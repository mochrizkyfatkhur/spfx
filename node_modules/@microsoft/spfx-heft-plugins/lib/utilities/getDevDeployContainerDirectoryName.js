"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDevDeployContainerDirectoryName = void 0;
const os_1 = require("os");
const git_repo_info_1 = __importDefault(require("git-repo-info"));
let cachedContainerName;
function getDevDeployContainerDirectoryName() {
    if (!cachedContainerName) {
        const baseContainerName = `dev-${getUserName()}-${(0, os_1.hostname)()}`;
        let leaf = process.cwd();
        try {
            const repoInfo = (0, git_repo_info_1.default)();
            if (repoInfo.root && repoInfo.branch) {
                leaf = `${repoInfo.root}-${repoInfo.branch}`;
            }
        }
        catch (err) {
            // Do nothing
        }
        // Ensure the path is URL-safe.
        cachedContainerName = `${baseContainerName}-${leaf}`.replace(/[^A-Za-z0-9\-\/]+/g, '_');
    }
    return cachedContainerName;
}
exports.getDevDeployContainerDirectoryName = getDevDeployContainerDirectoryName;
function getUserName() {
    return (process.env.USERNAME || process.env.LOGNAME || process.env.USER || process.env.LNAME || 'unknown_user');
}
//# sourceMappingURL=getDevDeployContainerDirectoryName.js.map